<%- include('partials/header') %>

<h2>Welcome to <%= title %></h2>
<p>This is a private community for members only.</p>

<% if (user) { %>
  <a href="/create-message" class="button">Create Message</a>
<% } %>

<div class="messages">
  <% if (locals.messages && messages.length > 0) { %>
    <% messages.forEach(function(message) { %>
      <div class="message-card">
        <h3><%= message.title %></h3>
        <p><%= message.content %></p>
        
        <div class="message-meta">
          <% if (user && (user.membership_status === 'member' || user.membership_status === 'admin')) { %>
            <span class="author">By <%= message.first_name %> <%= message.last_name %> (<%= message.username %>)</span>
            <span class="date">on <%= new Date(message.timestamp).toLocaleDateString() %></span>
          <% } else { %>
            <span class="author">By Anonymous</span>
          <% } %>
        </div>
      </div>
    <% }); %>
  <% } else { %>
    <p>No messages yet.</p>
  <% } %>
</div>

<%- include('partials/footer') %>
